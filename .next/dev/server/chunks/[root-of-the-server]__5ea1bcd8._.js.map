{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 58, "column": 0}, "map": {"version":3,"sources":["file:///Users/mats/Code/react-parallel-reader/app/api/books/route.ts"],"sourcesContent":["import { NextResponse } from 'next/server';\nimport fs from 'fs';\nimport path from 'path';\n\nexport const dynamic = 'force-dynamic';\n\nexport async function GET() {\n    const booksDirectory = path.join(process.cwd(), 'public/books');\n\n    try {\n        // Ensure directory exists\n        if (!fs.existsSync(booksDirectory)) {\n            return NextResponse.json([]);\n        }\n\n        const items = fs.readdirSync(booksDirectory);\n\n        // We look for subdirectories that act as \"collections\"\n        const collections = items\n            .filter((item) => {\n                const fullPath = path.join(booksDirectory, item);\n                return fs.statSync(fullPath).isDirectory();\n            })\n            .map((dirName) => {\n                const dirPath = path.join(booksDirectory, dirName);\n                const files = fs.readdirSync(dirPath)\n                    .filter((file) => file.endsWith('.epub'))\n                    .map((file) => `/books/${dirName}/${file}`);\n\n                return {\n                    name: dirName,\n                    files,\n                };\n            })\n            .filter((collection) => collection.files.length > 0);\n\n        return NextResponse.json(collections);\n    } catch (error) {\n        console.error('Error reading books directory:', error);\n        return NextResponse.json({ error: 'Failed to read books' }, { status: 500 });\n    }\n}\n"],"names":[],"mappings":";;;;;;AAAA;AACA;AACA;;;;AAEO,MAAM,UAAU;AAEhB,eAAe;IAClB,MAAM,iBAAiB,4GAAI,CAAC,IAAI,CAAC,QAAQ,GAAG,IAAI;IAEhD,IAAI;QACA,0BAA0B;QAC1B,IAAI,CAAC,wGAAE,CAAC,UAAU,CAAC,iBAAiB;YAChC,OAAO,gJAAY,CAAC,IAAI,CAAC,EAAE;QAC/B;QAEA,MAAM,QAAQ,wGAAE,CAAC,WAAW,CAAC;QAE7B,uDAAuD;QACvD,MAAM,cAAc,MACf,MAAM,CAAC,CAAC;YACL,MAAM,WAAW,4GAAI,CAAC,IAAI,CAAC,gBAAgB;YAC3C,OAAO,wGAAE,CAAC,QAAQ,CAAC,UAAU,WAAW;QAC5C,GACC,GAAG,CAAC,CAAC;YACF,MAAM,UAAU,4GAAI,CAAC,IAAI,CAAC,gBAAgB;YAC1C,MAAM,QAAQ,wGAAE,CAAC,WAAW,CAAC,SACxB,MAAM,CAAC,CAAC,OAAS,KAAK,QAAQ,CAAC,UAC/B,GAAG,CAAC,CAAC,OAAS,CAAC,OAAO,EAAE,QAAQ,CAAC,EAAE,MAAM;YAE9C,OAAO;gBACH,MAAM;gBACN;YACJ;QACJ,GACC,MAAM,CAAC,CAAC,aAAe,WAAW,KAAK,CAAC,MAAM,GAAG;QAEtD,OAAO,gJAAY,CAAC,IAAI,CAAC;IAC7B,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,kCAAkC;QAChD,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAuB,GAAG;YAAE,QAAQ;QAAI;IAC9E;AACJ"}}]
}