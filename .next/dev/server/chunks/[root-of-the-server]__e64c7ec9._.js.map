{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 58, "column": 0}, "map": {"version":3,"sources":["file:///Users/mats/Code/react-parallel-reader/app/api/highlights/route.ts"],"sourcesContent":["import { NextResponse } from 'next/server';\nimport fs from 'fs';\nimport path from 'path';\n\nexport const dynamic = 'force-dynamic';\n\nconst highlightPath = path.join(process.cwd(), 'public/highlights.json');\n\n// Interface matching the front-end structure we will use\ninterface Highlight {\n    id: string;\n    cfiRange: string;\n    text: string;\n    bookUrl: string;\n    color?: string;\n    created: number;\n}\n\n// GET: Retrieve all highlights\nexport async function GET() {\n    try {\n        if (!fs.existsSync(highlightPath)) {\n            return NextResponse.json([]);\n        }\n        const fileContent = fs.readFileSync(highlightPath, 'utf-8');\n        const highlights = JSON.parse(fileContent);\n        return NextResponse.json(highlights);\n    } catch (error) {\n        console.error('Error reading highlights:', error);\n        return NextResponse.json([]);\n    }\n}\n\n// POST: Save a new highlight\nexport async function POST(req: Request) {\n    try {\n        const newHighlight: Highlight = await req.json();\n\n        let highlights: Highlight[] = [];\n        if (fs.existsSync(highlightPath)) {\n            const fileContent = fs.readFileSync(highlightPath, 'utf-8');\n            highlights = JSON.parse(fileContent);\n        }\n\n        highlights.push(newHighlight);\n        fs.writeFileSync(highlightPath, JSON.stringify(highlights, null, 2));\n\n        return NextResponse.json({ success: true, highlights });\n    } catch (error) {\n        console.error('Error saving highlight:', error);\n        return NextResponse.json({ error: 'Failed to save highlight' }, { status: 500 });\n    }\n}\n\n// DELETE: Remove a highlight\nexport async function DELETE(req: Request) {\n    try {\n        const { id } = await req.json();\n\n        if (!fs.existsSync(highlightPath)) {\n            return NextResponse.json({ success: false, message: \"No file\" });\n        }\n\n        const fileContent = fs.readFileSync(highlightPath, 'utf-8');\n        let highlights: Highlight[] = JSON.parse(fileContent);\n\n        highlights = highlights.filter(h => h.id !== id);\n\n        fs.writeFileSync(highlightPath, JSON.stringify(highlights, null, 2));\n        return NextResponse.json({ success: true, highlights });\n\n    } catch (error) {\n        console.error('Error deleting highlight:', error);\n        return NextResponse.json({ error: 'Failed to delete' }, { status: 500 });\n    }\n}\n"],"names":[],"mappings":";;;;;;;;;;AAAA;AACA;AACA;;;;AAEO,MAAM,UAAU;AAEvB,MAAM,gBAAgB,4GAAI,CAAC,IAAI,CAAC,QAAQ,GAAG,IAAI;AAaxC,eAAe;IAClB,IAAI;QACA,IAAI,CAAC,wGAAE,CAAC,UAAU,CAAC,gBAAgB;YAC/B,OAAO,gJAAY,CAAC,IAAI,CAAC,EAAE;QAC/B;QACA,MAAM,cAAc,wGAAE,CAAC,YAAY,CAAC,eAAe;QACnD,MAAM,aAAa,KAAK,KAAK,CAAC;QAC9B,OAAO,gJAAY,CAAC,IAAI,CAAC;IAC7B,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,6BAA6B;QAC3C,OAAO,gJAAY,CAAC,IAAI,CAAC,EAAE;IAC/B;AACJ;AAGO,eAAe,KAAK,GAAY;IACnC,IAAI;QACA,MAAM,eAA0B,MAAM,IAAI,IAAI;QAE9C,IAAI,aAA0B,EAAE;QAChC,IAAI,wGAAE,CAAC,UAAU,CAAC,gBAAgB;YAC9B,MAAM,cAAc,wGAAE,CAAC,YAAY,CAAC,eAAe;YACnD,aAAa,KAAK,KAAK,CAAC;QAC5B;QAEA,WAAW,IAAI,CAAC;QAChB,wGAAE,CAAC,aAAa,CAAC,eAAe,KAAK,SAAS,CAAC,YAAY,MAAM;QAEjE,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS;YAAM;QAAW;IACzD,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,2BAA2B;QACzC,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAA2B,GAAG;YAAE,QAAQ;QAAI;IAClF;AACJ;AAGO,eAAe,OAAO,GAAY;IACrC,IAAI;QACA,MAAM,EAAE,EAAE,EAAE,GAAG,MAAM,IAAI,IAAI;QAE7B,IAAI,CAAC,wGAAE,CAAC,UAAU,CAAC,gBAAgB;YAC/B,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,SAAS;gBAAO,SAAS;YAAU;QAClE;QAEA,MAAM,cAAc,wGAAE,CAAC,YAAY,CAAC,eAAe;QACnD,IAAI,aAA0B,KAAK,KAAK,CAAC;QAEzC,aAAa,WAAW,MAAM,CAAC,CAAA,IAAK,EAAE,EAAE,KAAK;QAE7C,wGAAE,CAAC,aAAa,CAAC,eAAe,KAAK,SAAS,CAAC,YAAY,MAAM;QACjE,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS;YAAM;QAAW;IAEzD,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,6BAA6B;QAC3C,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAmB,GAAG;YAAE,QAAQ;QAAI;IAC1E;AACJ"}}]
}