{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 9, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/app/components/ParallelReader.module.scss [app-ssr] (css module)"],"sourcesContent":["__turbopack_context__.v({\n  \"active\": \"ParallelReader-module-scss-module__rbxfja__active\",\n  \"buttonGroup\": \"ParallelReader-module-scss-module__rbxfja__buttonGroup\",\n  \"container\": \"ParallelReader-module-scss-module__rbxfja__container\",\n  \"controls\": \"ParallelReader-module-scss-module__rbxfja__controls\",\n  \"grid\": \"ParallelReader-module-scss-module__rbxfja__grid\",\n  \"header\": \"ParallelReader-module-scss-module__rbxfja__header\",\n  \"inactive\": \"ParallelReader-module-scss-module__rbxfja__inactive\",\n  \"inputWrapper\": \"ParallelReader-module-scss-module__rbxfja__inputWrapper\",\n  \"panel\": \"ParallelReader-module-scss-module__rbxfja__panel\",\n  \"readerWrapper\": \"ParallelReader-module-scss-module__rbxfja__readerWrapper\",\n});\n"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA"}},
    {"offset": {"line": 25, "column": 0}, "map": {"version":3,"sources":["file:///Users/mats/Code/react-parallel-reader/app/components/ParallelReader.tsx"],"sourcesContent":["'use client';\n\nimport React, { useState, useRef } from 'react';\nimport { ReactReader } from 'react-reader';\nimport styles from './ParallelReader.module.scss';\nimport type { Rendition } from '../../types/epub';\n\n// Define a type for the location (can be a string CFI or integer 0)\ntype LocationType = string | number;\n\ninterface ParallelReaderProps {\n    initialUrls: string[];\n    onBack?: () => void;\n}\n\nexport default function ParallelReader({ initialUrls, onBack }: ParallelReaderProps) {\n    // --- State ---\n    const [urls, setUrls] = useState<string[]>(initialUrls);\n    const [count, setCount] = useState(initialUrls.length || 2);\n    // NEW: We must track the location of each book individually\n    const [locations, setLocations] = useState<LocationType[]>(initialUrls.map(() => 0));\n\n    const renditionRefs = useRef<(Rendition | null)[]>([]);\n\n    // --- Handlers ---\n\n    const getRendition = (index: number, rendition: Rendition) => {\n        renditionRefs.current[index] = rendition;\n\n        // Inject styles INSIDE the iframe (SASS cannot reach here)\n        rendition.themes.default({\n            'p': {\n                'font-family': 'Helvetica, sans-serif',\n                'font-size': '1.1rem',\n                'line-height': '1.6'\n            },\n            'div': { 'padding-bottom': '20px' }\n        });\n    };\n\n    const handleLocationChange = (index: number, newLocation: LocationType) => {\n        // 1. Update the state for THIS book so it doesn't get \"stuck\"\n        const newLocations = [...locations];\n        newLocations[index] = newLocation;\n        setLocations(newLocations);\n    };\n\n    const updateUrl = (index: number, newUrl: string) => {\n        const newUrls = [...urls];\n        newUrls[index] = newUrl;\n        setUrls(newUrls);\n    };\n\n    return (\n        <div className={styles.container}>\n            <div className={styles.header}>\n                <div style={{ display: 'flex', alignItems: 'center', gap: '1rem' }}>\n                    {onBack && (\n                        <button\n                            onClick={onBack}\n                            className={styles.backButton}\n                            style={{\n                                background: 'none', border: 'none', cursor: 'pointer', fontSize: '1.2rem'\n                            }}\n                        >\n                            ← Back\n                        </button>\n                    )}\n                    <h1>Parallel Reader</h1>\n                </div>\n                <div className={styles.controls}>\n                    <div className={styles.buttonGroup}>\n                        {[1, 2, 3].map(num => (\n                            <button\n                                key={num}\n                                onClick={() => setCount(num)}\n                                className={count === num ? styles.active : styles.inactive}\n                            >\n                                {num} Panel{num > 1 && 's'}\n                            </button>\n                        ))}\n                    </div>\n                </div>\n            </div>\n\n            <div className={styles.grid}>\n                {Array.from({ length: count }).map((_, index) => (\n                    <div\n                        key={index}\n                        className={styles.panel}\n                        style={{ maxWidth: `${100 / count}%` }}\n                    >\n                        <div className={styles.inputWrapper}>\n                            <input\n                                type=\"text\"\n                                placeholder=\"Paste EPUB URL here...\"\n                                value={urls[index] || ''}\n                                onChange={(e) => updateUrl(index, e.target.value)}\n                            />\n                        </div>\n\n                        <div className={styles.readerWrapper}>\n                            <ReactReader\n                                url={urls[index]}\n\n                                // REQUIRED PROP: Controls where the book is\n                                location={locations[index] || 0}\n\n                                // REQUIRED PROP: Updates the state when user scrolls\n                                locationChanged={(loc) => handleLocationChange(index, loc)}\n\n                                getRendition={(rendition) => getRendition(index, rendition)}\n                                epubOptions={{\n                                    flow: \"scrolled\",\n                                    manager: \"continuous\",\n                                }}\n                            />\n                        </div>\n                    </div>\n                ))}\n            </div>\n        </div>\n    );\n}"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAJA;;;;;AAee,SAAS,eAAe,EAAE,WAAW,EAAE,MAAM,EAAuB;IAC/E,gBAAgB;IAChB,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,iNAAQ,EAAW;IAC3C,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,iNAAQ,EAAC,YAAY,MAAM,IAAI;IACzD,4DAA4D;IAC5D,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,iNAAQ,EAAiB,YAAY,GAAG,CAAC,IAAM;IAEjF,MAAM,gBAAgB,IAAA,+MAAM,EAAuB,EAAE;IAErD,mBAAmB;IAEnB,MAAM,eAAe,CAAC,OAAe;QACjC,cAAc,OAAO,CAAC,MAAM,GAAG;QAE/B,2DAA2D;QAC3D,UAAU,MAAM,CAAC,OAAO,CAAC;YACrB,KAAK;gBACD,eAAe;gBACf,aAAa;gBACb,eAAe;YACnB;YACA,OAAO;gBAAE,kBAAkB;YAAO;QACtC;IACJ;IAEA,MAAM,uBAAuB,CAAC,OAAe;QACzC,8DAA8D;QAC9D,MAAM,eAAe;eAAI;SAAU;QACnC,YAAY,CAAC,MAAM,GAAG;QACtB,aAAa;IACjB;IAEA,MAAM,YAAY,CAAC,OAAe;QAC9B,MAAM,UAAU;eAAI;SAAK;QACzB,OAAO,CAAC,MAAM,GAAG;QACjB,QAAQ;IACZ;IAEA,qBACI,8OAAC;QAAI,WAAW,2JAAM,CAAC,SAAS;;0BAC5B,8OAAC;gBAAI,WAAW,2JAAM,CAAC,MAAM;;kCACzB,8OAAC;wBAAI,OAAO;4BAAE,SAAS;4BAAQ,YAAY;4BAAU,KAAK;wBAAO;;4BAC5D,wBACG,8OAAC;gCACG,SAAS;gCACT,WAAW,2JAAM,CAAC,UAAU;gCAC5B,OAAO;oCACH,YAAY;oCAAQ,QAAQ;oCAAQ,QAAQ;oCAAW,UAAU;gCACrE;0CACH;;;;;;0CAIL,8OAAC;0CAAG;;;;;;;;;;;;kCAER,8OAAC;wBAAI,WAAW,2JAAM,CAAC,QAAQ;kCAC3B,cAAA,8OAAC;4BAAI,WAAW,2JAAM,CAAC,WAAW;sCAC7B;gCAAC;gCAAG;gCAAG;6BAAE,CAAC,GAAG,CAAC,CAAA,oBACX,8OAAC;oCAEG,SAAS,IAAM,SAAS;oCACxB,WAAW,UAAU,MAAM,2JAAM,CAAC,MAAM,GAAG,2JAAM,CAAC,QAAQ;;wCAEzD;wCAAI;wCAAO,MAAM,KAAK;;mCAJlB;;;;;;;;;;;;;;;;;;;;;0BAWzB,8OAAC;gBAAI,WAAW,2JAAM,CAAC,IAAI;0BACtB,MAAM,IAAI,CAAC;oBAAE,QAAQ;gBAAM,GAAG,GAAG,CAAC,CAAC,GAAG,sBACnC,8OAAC;wBAEG,WAAW,2JAAM,CAAC,KAAK;wBACvB,OAAO;4BAAE,UAAU,GAAG,MAAM,MAAM,CAAC,CAAC;wBAAC;;0CAErC,8OAAC;gCAAI,WAAW,2JAAM,CAAC,YAAY;0CAC/B,cAAA,8OAAC;oCACG,MAAK;oCACL,aAAY;oCACZ,OAAO,IAAI,CAAC,MAAM,IAAI;oCACtB,UAAU,CAAC,IAAM,UAAU,OAAO,EAAE,MAAM,CAAC,KAAK;;;;;;;;;;;0CAIxD,8OAAC;gCAAI,WAAW,2JAAM,CAAC,aAAa;0CAChC,cAAA,8OAAC,+KAAW;oCACR,KAAK,IAAI,CAAC,MAAM;oCAEhB,4CAA4C;oCAC5C,UAAU,SAAS,CAAC,MAAM,IAAI;oCAE9B,qDAAqD;oCACrD,iBAAiB,CAAC,MAAQ,qBAAqB,OAAO;oCAEtD,cAAc,CAAC,YAAc,aAAa,OAAO;oCACjD,aAAa;wCACT,MAAM;wCACN,SAAS;oCACb;;;;;;;;;;;;uBA3BH;;;;;;;;;;;;;;;;AAmC7B"}},
    {"offset": {"line": 224, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/app/components/Bookshelf.module.scss [app-ssr] (css module)"],"sourcesContent":["__turbopack_context__.v({\n  \"arrow\": \"Bookshelf-module-scss-module__3Di2QW__arrow\",\n  \"bookCount\": \"Bookshelf-module-scss-module__3Di2QW__bookCount\",\n  \"card\": \"Bookshelf-module-scss-module__3Di2QW__card\",\n  \"cardContent\": \"Bookshelf-module-scss-module__3Di2QW__cardContent\",\n  \"collectionName\": \"Bookshelf-module-scss-module__3Di2QW__collectionName\",\n  \"container\": \"Bookshelf-module-scss-module__3Di2QW__container\",\n  \"emptyState\": \"Bookshelf-module-scss-module__3Di2QW__emptyState\",\n  \"list\": \"Bookshelf-module-scss-module__3Di2QW__list\",\n  \"loading\": \"Bookshelf-module-scss-module__3Di2QW__loading\",\n  \"subtitle\": \"Bookshelf-module-scss-module__3Di2QW__subtitle\",\n  \"title\": \"Bookshelf-module-scss-module__3Di2QW__title\",\n});\n"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA"}},
    {"offset": {"line": 241, "column": 0}, "map": {"version":3,"sources":["file:///Users/mats/Code/react-parallel-reader/app/components/Bookshelf.tsx"],"sourcesContent":["'use client';\n\nimport React, { useEffect, useState } from 'react';\nimport type { BookCollection } from '../../types/epub';\nimport styles from './Bookshelf.module.scss';\n\ninterface BookshelfProps {\n    onSelectCollection: (files: string[]) => void;\n}\n\nexport default function Bookshelf({ onSelectCollection }: BookshelfProps) {\n    const [collections, setCollections] = useState<BookCollection[]>([]);\n    const [loading, setLoading] = useState(true);\n\n    useEffect(() => {\n        fetch('/api/books')\n            .then((res) => res.json())\n            .then((data) => {\n                setCollections(data);\n                setLoading(false);\n            })\n            .catch((err) => {\n                console.error('Failed to load books:', err);\n                setLoading(false);\n            });\n    }, []);\n\n    if (loading) return <div className={styles.loading}>Loading library...</div>;\n\n    return (\n        <div className={styles.container}>\n            <h1 className={styles.title}>My Collections</h1>\n\n            {collections.length === 0 ? (\n                <div className={styles.emptyState}>\n                    <p>No collections found in <code>public/books/</code>.</p>\n                    <p className={styles.subtitle}>Create a subfolder (e.g., <code>public/books/classics/</code>) and add EPUB files to start.</p>\n                </div>\n            ) : (\n                <div className={styles.list}>\n                    {collections.map((collection) => (\n                        <div\n                            key={collection.name}\n                            className={styles.card}\n                            onClick={() => onSelectCollection(collection.files)}\n                        >\n                            <div className={styles.cardContent}>\n                                <div>\n                                    <h3 className={styles.collectionName}>\n                                        {collection.name.replace(/-/g, ' ')}\n                                    </h3>\n                                    <p className={styles.bookCount}>\n                                        {collection.files.length} book{collection.files.length !== 1 && 's'}\n                                    </p>\n                                </div>\n                                <div className={styles.arrow}>\n                                    <span style={{ fontSize: '1.5rem' }}>→</span>\n                                </div>\n                            </div>\n                        </div>\n                    ))}\n                </div>\n            )}\n        </div>\n    );\n}\n"],"names":[],"mappings":";;;;;AAEA;AAEA;AAJA;;;;AAUe,SAAS,UAAU,EAAE,kBAAkB,EAAkB;IACpE,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,iNAAQ,EAAmB,EAAE;IACnE,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,iNAAQ,EAAC;IAEvC,IAAA,kNAAS,EAAC;QACN,MAAM,cACD,IAAI,CAAC,CAAC,MAAQ,IAAI,IAAI,IACtB,IAAI,CAAC,CAAC;YACH,eAAe;YACf,WAAW;QACf,GACC,KAAK,CAAC,CAAC;YACJ,QAAQ,KAAK,CAAC,yBAAyB;YACvC,WAAW;QACf;IACR,GAAG,EAAE;IAEL,IAAI,SAAS,qBAAO,8OAAC;QAAI,WAAW,sJAAM,CAAC,OAAO;kBAAE;;;;;;IAEpD,qBACI,8OAAC;QAAI,WAAW,sJAAM,CAAC,SAAS;;0BAC5B,8OAAC;gBAAG,WAAW,sJAAM,CAAC,KAAK;0BAAE;;;;;;YAE5B,YAAY,MAAM,KAAK,kBACpB,8OAAC;gBAAI,WAAW,sJAAM,CAAC,UAAU;;kCAC7B,8OAAC;;4BAAE;0CAAwB,8OAAC;0CAAK;;;;;;4BAAoB;;;;;;;kCACrD,8OAAC;wBAAE,WAAW,sJAAM,CAAC,QAAQ;;4BAAE;0CAA0B,8OAAC;0CAAK;;;;;;4BAA6B;;;;;;;;;;;;qCAGhG,8OAAC;gBAAI,WAAW,sJAAM,CAAC,IAAI;0BACtB,YAAY,GAAG,CAAC,CAAC,2BACd,8OAAC;wBAEG,WAAW,sJAAM,CAAC,IAAI;wBACtB,SAAS,IAAM,mBAAmB,WAAW,KAAK;kCAElD,cAAA,8OAAC;4BAAI,WAAW,sJAAM,CAAC,WAAW;;8CAC9B,8OAAC;;sDACG,8OAAC;4CAAG,WAAW,sJAAM,CAAC,cAAc;sDAC/B,WAAW,IAAI,CAAC,OAAO,CAAC,MAAM;;;;;;sDAEnC,8OAAC;4CAAE,WAAW,sJAAM,CAAC,SAAS;;gDACzB,WAAW,KAAK,CAAC,MAAM;gDAAC;gDAAM,WAAW,KAAK,CAAC,MAAM,KAAK,KAAK;;;;;;;;;;;;;8CAGxE,8OAAC;oCAAI,WAAW,sJAAM,CAAC,KAAK;8CACxB,cAAA,8OAAC;wCAAK,OAAO;4CAAE,UAAU;wCAAS;kDAAG;;;;;;;;;;;;;;;;;uBAdxC,WAAW,IAAI;;;;;;;;;;;;;;;;AAuBhD"}},
    {"offset": {"line": 406, "column": 0}, "map": {"version":3,"sources":["file:///Users/mats/Code/react-parallel-reader/app/page.tsx"],"sourcesContent":["'use client';\n\nimport React, { useState } from \"react\";\nimport ParallelReader from \"./components/ParallelReader\";\nimport Bookshelf from \"./components/Bookshelf\";\n\nexport default function Home() {\n  const [selectedBooks, setSelectedBooks] = useState<string[] | null>(null);\n\n  return (\n    <main className=\"min-h-screen bg-gray-50\">\n      {selectedBooks ? (\n        <ParallelReader\n          initialUrls={selectedBooks}\n          onBack={() => setSelectedBooks(null)}\n        />\n      ) : (\n        <Bookshelf onSelectCollection={setSelectedBooks} />\n      )}\n    </main>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAJA;;;;;AAMe,SAAS;IACtB,MAAM,CAAC,eAAe,iBAAiB,GAAG,IAAA,iNAAQ,EAAkB;IAEpE,qBACE,8OAAC;QAAK,WAAU;kBACb,8BACC,8OAAC,+IAAc;YACb,aAAa;YACb,QAAQ,IAAM,iBAAiB;;;;;iCAGjC,8OAAC,0IAAS;YAAC,oBAAoB;;;;;;;;;;;AAIvC"}}]
}