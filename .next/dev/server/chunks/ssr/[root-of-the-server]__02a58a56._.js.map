{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///Users/mats/Code/react-parallel-reader/app/hooks/useDebounce.ts"],"sourcesContent":["import { useEffect, useRef } from 'react';\n\nexport function useDebounce<T extends (...args: any[]) => void>(callback: T, delay: number) {\n    const timeoutRef = useRef<NodeJS.Timeout | null>(null);\n\n    useEffect(() => {\n        // Cleanup the previous timeout on unmount\n        return () => {\n            if (timeoutRef.current) {\n                clearTimeout(timeoutRef.current);\n            }\n        };\n    }, []);\n\n    const debouncedCallback = (...args: Parameters<T>) => {\n        if (timeoutRef.current) {\n            clearTimeout(timeoutRef.current);\n        }\n\n        timeoutRef.current = setTimeout(() => {\n            callback(...args);\n        }, delay);\n    };\n\n    return debouncedCallback;\n}\n"],"names":[],"mappings":";;;;AAAA;;AAEO,SAAS,YAAgD,QAAW,EAAE,KAAa;IACtF,MAAM,aAAa,IAAA,+MAAM,EAAwB;IAEjD,IAAA,kNAAS,EAAC;QACN,0CAA0C;QAC1C,OAAO;YACH,IAAI,WAAW,OAAO,EAAE;gBACpB,aAAa,WAAW,OAAO;YACnC;QACJ;IACJ,GAAG,EAAE;IAEL,MAAM,oBAAoB,CAAC,GAAG;QAC1B,IAAI,WAAW,OAAO,EAAE;YACpB,aAAa,WAAW,OAAO;QACnC;QAEA,WAAW,OAAO,GAAG,WAAW;YAC5B,YAAY;QAChB,GAAG;IACP;IAEA,OAAO;AACX"}},
    {"offset": {"line": 39, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/app/components/ParallelReader.module.scss [app-ssr] (css module)"],"sourcesContent":["__turbopack_context__.v({\n  \"actions\": \"ParallelReader-module-scss-module__rbxfja__actions\",\n  \"active\": \"ParallelReader-module-scss-module__rbxfja__active\",\n  \"annotationCard\": \"ParallelReader-module-scss-module__rbxfja__annotationCard\",\n  \"buttonGroup\": \"ParallelReader-module-scss-module__rbxfja__buttonGroup\",\n  \"cancelBtn\": \"ParallelReader-module-scss-module__rbxfja__cancelBtn\",\n  \"colorOptions\": \"ParallelReader-module-scss-module__rbxfja__colorOptions\",\n  \"container\": \"ParallelReader-module-scss-module__rbxfja__container\",\n  \"controls\": \"ParallelReader-module-scss-module__rbxfja__controls\",\n  \"delete\": \"ParallelReader-module-scss-module__rbxfja__delete\",\n  \"emptyState\": \"ParallelReader-module-scss-module__rbxfja__emptyState\",\n  \"footer\": \"ParallelReader-module-scss-module__rbxfja__footer\",\n  \"formGroup\": \"ParallelReader-module-scss-module__rbxfja__formGroup\",\n  \"grid\": \"ParallelReader-module-scss-module__rbxfja__grid\",\n  \"header\": \"ParallelReader-module-scss-module__rbxfja__header\",\n  \"inactive\": \"ParallelReader-module-scss-module__rbxfja__inactive\",\n  \"inputWrapper\": \"ParallelReader-module-scss-module__rbxfja__inputWrapper\",\n  \"jump\": \"ParallelReader-module-scss-module__rbxfja__jump\",\n  \"panel\": \"ParallelReader-module-scss-module__rbxfja__panel\",\n  \"popoverButton\": \"ParallelReader-module-scss-module__rbxfja__popoverButton\",\n  \"popoverContainer\": \"ParallelReader-module-scss-module__rbxfja__popoverContainer\",\n  \"readerWrapper\": \"ParallelReader-module-scss-module__rbxfja__readerWrapper\",\n  \"saveBtn\": \"ParallelReader-module-scss-module__rbxfja__saveBtn\",\n  \"selected\": \"ParallelReader-module-scss-module__rbxfja__selected\",\n  \"selectionMenu\": \"ParallelReader-module-scss-module__rbxfja__selectionMenu\",\n  \"settingGroup\": \"ParallelReader-module-scss-module__rbxfja__settingGroup\",\n  \"settingsPanel\": \"ParallelReader-module-scss-module__rbxfja__settingsPanel\",\n  \"sidebar\": \"ParallelReader-module-scss-module__rbxfja__sidebar\",\n  \"styleOptions\": \"ParallelReader-module-scss-module__rbxfja__styleOptions\",\n});\n"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA"}},
    {"offset": {"line": 73, "column": 0}, "map": {"version":3,"sources":["file:///Users/mats/Code/react-parallel-reader/app/components/SelectionMenu.tsx"],"sourcesContent":["\nimport React, { useState } from 'react';\nimport styles from './ParallelReader.module.scss';\nimport { Highlight } from '../../types/epub';\n\ninterface SelectionMenuProps {\n    initialData?: Partial<Highlight>;\n    onSave: (data: { color: string; style: 'highlight' | 'underline'; note: string }) => void;\n    onCancel: () => void;\n    onDelete?: () => void;\n    onJump?: () => void;\n    isEditing: boolean;\n}\n\nexport default function SelectionMenu({ initialData, onSave, onCancel, onDelete, onJump, isEditing }: SelectionMenuProps) {\n    const [color, setColor] = useState(initialData?.color || '#ffeb3b');\n    const [style, setStyle] = useState<'highlight' | 'underline'>(initialData?.style || 'highlight');\n    const [note, setNote] = useState(initialData?.note || '');\n\n    const colors = [\n        '#ffeb3b', // Yellow\n        '#a5f3fc', // Cyan\n        '#bbf7d0', // Green\n        '#fbcfe8', // Pink\n        '#e9d5ff'  // Purple\n    ];\n\n    return (\n        <div className={styles.selectionMenu}>\n            {/* Context Actions (only for existing) */}\n            {isEditing && (\n                <div className={styles.menuHeader}>\n                    {onJump && <button onClick={onJump} className={styles.iconBtn} title=\"Jump to location\">üìç</button>}\n                    {onDelete && <button onClick={onDelete} className={styles.iconBtn} title=\"Delete\">üóëÔ∏è</button>}\n                    <span className={styles.spacer} />\n                    <button onClick={onCancel} className={styles.closeBtn}>√ó</button>\n                </div>\n            )}\n\n            {!isEditing && (\n                <div className={styles.menuHeaderSimple}>\n                    <strong>Add Annotation</strong>\n                    <button onClick={onCancel} className={styles.closeBtn}>√ó</button>\n                </div>\n            )}\n\n            <div className={styles.row}>\n                <label>Style:</label>\n                <div className={styles.toggleGroup}>\n                    <button\n                        className={style === 'highlight' ? styles.active : ''}\n                        onClick={() => setStyle('highlight')}\n                    >\n                        Highlight\n                    </button>\n                    <button\n                        className={style === 'underline' ? styles.active : ''}\n                        onClick={() => setStyle('underline')}\n                    >\n                        Underline\n                    </button>\n                </div>\n            </div>\n\n            <div className={styles.row}>\n                <label>Color:</label>\n                <div className={styles.colorSwatches}>\n                    {colors.map(c => (\n                        <button\n                            key={c}\n                            style={{ backgroundColor: c, border: color === c ? '2px solid #555' : '1px solid #ddd' }}\n                            onClick={() => setColor(c)}\n                            className={styles.swatch}\n                        />\n                    ))}\n                </div>\n            </div>\n\n            <div className={styles.noteParams}>\n                <textarea\n                    placeholder=\"Add a note...\"\n                    value={note}\n                    onChange={(e) => setNote(e.target.value)}\n                    rows={3}\n                />\n            </div>\n\n            <div className={styles.actions}>\n                <button className={styles.saveBtn} onClick={() => onSave({ color, style, note })}>\n                    {isEditing ? 'Update' : 'Save'}\n                </button>\n            </div>\n        </div>\n    );\n}\n"],"names":[],"mappings":";;;;;AACA;AACA;;;;AAYe,SAAS,cAAc,EAAE,WAAW,EAAE,MAAM,EAAE,QAAQ,EAAE,QAAQ,EAAE,MAAM,EAAE,SAAS,EAAsB;IACpH,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,iNAAQ,EAAC,aAAa,SAAS;IACzD,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,iNAAQ,EAA4B,aAAa,SAAS;IACpF,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,iNAAQ,EAAC,aAAa,QAAQ;IAEtD,MAAM,SAAS;QACX;QACA;QACA;QACA;QACA,UAAW,SAAS;KACvB;IAED,qBACI,8OAAC;QAAI,WAAW,2JAAM,CAAC,aAAa;;YAE/B,2BACG,8OAAC;gBAAI,WAAW,2JAAM,CAAC,UAAU;;oBAC5B,wBAAU,8OAAC;wBAAO,SAAS;wBAAQ,WAAW,2JAAM,CAAC,OAAO;wBAAE,OAAM;kCAAmB;;;;;;oBACvF,0BAAY,8OAAC;wBAAO,SAAS;wBAAU,WAAW,2JAAM,CAAC,OAAO;wBAAE,OAAM;kCAAS;;;;;;kCAClF,8OAAC;wBAAK,WAAW,2JAAM,CAAC,MAAM;;;;;;kCAC9B,8OAAC;wBAAO,SAAS;wBAAU,WAAW,2JAAM,CAAC,QAAQ;kCAAE;;;;;;;;;;;;YAI9D,CAAC,2BACE,8OAAC;gBAAI,WAAW,2JAAM,CAAC,gBAAgB;;kCACnC,8OAAC;kCAAO;;;;;;kCACR,8OAAC;wBAAO,SAAS;wBAAU,WAAW,2JAAM,CAAC,QAAQ;kCAAE;;;;;;;;;;;;0BAI/D,8OAAC;gBAAI,WAAW,2JAAM,CAAC,GAAG;;kCACtB,8OAAC;kCAAM;;;;;;kCACP,8OAAC;wBAAI,WAAW,2JAAM,CAAC,WAAW;;0CAC9B,8OAAC;gCACG,WAAW,UAAU,cAAc,2JAAM,CAAC,MAAM,GAAG;gCACnD,SAAS,IAAM,SAAS;0CAC3B;;;;;;0CAGD,8OAAC;gCACG,WAAW,UAAU,cAAc,2JAAM,CAAC,MAAM,GAAG;gCACnD,SAAS,IAAM,SAAS;0CAC3B;;;;;;;;;;;;;;;;;;0BAMT,8OAAC;gBAAI,WAAW,2JAAM,CAAC,GAAG;;kCACtB,8OAAC;kCAAM;;;;;;kCACP,8OAAC;wBAAI,WAAW,2JAAM,CAAC,aAAa;kCAC/B,OAAO,GAAG,CAAC,CAAA,kBACR,8OAAC;gCAEG,OAAO;oCAAE,iBAAiB;oCAAG,QAAQ,UAAU,IAAI,mBAAmB;gCAAiB;gCACvF,SAAS,IAAM,SAAS;gCACxB,WAAW,2JAAM,CAAC,MAAM;+BAHnB;;;;;;;;;;;;;;;;0BASrB,8OAAC;gBAAI,WAAW,2JAAM,CAAC,UAAU;0BAC7B,cAAA,8OAAC;oBACG,aAAY;oBACZ,OAAO;oBACP,UAAU,CAAC,IAAM,QAAQ,EAAE,MAAM,CAAC,KAAK;oBACvC,MAAM;;;;;;;;;;;0BAId,8OAAC;gBAAI,WAAW,2JAAM,CAAC,OAAO;0BAC1B,cAAA,8OAAC;oBAAO,WAAW,2JAAM,CAAC,OAAO;oBAAE,SAAS,IAAM,OAAO;4BAAE;4BAAO;4BAAO;wBAAK;8BACzE,YAAY,WAAW;;;;;;;;;;;;;;;;;AAK5C"}},
    {"offset": {"line": 293, "column": 0}, "map": {"version":3,"sources":["file:///Users/mats/Code/react-parallel-reader/app/components/ParallelReader.tsx"],"sourcesContent":["import React, { useState, useRef, useEffect } from 'react';\nimport { ReactReader, ReactReaderStyle } from 'react-reader';\nimport { useDebounce } from '../hooks/useDebounce';\nimport styles from './ParallelReader.module.scss';\nimport type { Rendition, Highlight } from '../../types/epub';\nimport SelectionMenu from './SelectionMenu';\n\n// Define a type for the location (can be a string CFI or integer 0)\ntype LocationType = string | number;\n\ninterface ParallelReaderProps {\n    initialUrls: string[];\n    onBack?: () => void;\n}\n\ninterface SelectionState {\n    cfiRange: string;\n    text: string;\n    bookIndex: number;\n    position: { top: number; left: number }; // Absolute position for popover\n    tempHighlightId?: string; // If we pre-highlight visually\n}\n\nexport default function ParallelReader({ initialUrls, onBack }: ParallelReaderProps) {\n    // --- State ---\n    const [urls, setUrls] = useState<string[]>(initialUrls);\n    const [count, setCount] = useState(initialUrls.length || 2);\n    // NEW: We must track the location of each book individually\n    const [locations, setLocations] = useState<LocationType[]>(initialUrls.map(() => 0));\n\n    // Highlights State\n    const [highlights, setHighlights] = useState<Highlight[]>([]);\n    const [showHighlights, setShowHighlights] = useState(true);\n\n    // Selection / Popover State\n    const [selection, setSelection] = useState<SelectionState | null>(null);\n    const [menuOpen, setMenuOpen] = useState(false);\n    const [editingHighlight, setEditingHighlight] = useState<Highlight | null>(null);\n\n    // Styling State\n    const [showSettings, setShowSettings] = useState(false);\n    const [settings, setSettings] = useState({\n        fontSize: 100, // percentage\n        fontFamily: 'Helvetica, sans-serif',\n        lineHeight: 1.6\n    });\n\n    const renditionRefs = useRef<(Rendition | null)[]>([]);\n    // Track rendered highlights per panel to prevent duplicates\n    const renderedRef = useRef<Set<string>>(new Set());\n\n    // Panel refs to calculate offsets for popovers\n    const panelRefs = useRef<(HTMLDivElement | null)[]>([]);\n\n    // Persistence: Hydrate locations from localStorage on mount\n    useEffect(() => {\n        try {\n            const saved = localStorage.getItem('parallel-reader-progress');\n            if (saved) {\n                const progress = JSON.parse(saved);\n\n                // Update locations based on URLs\n                // We map over current *urls* state to ensure we align with what's visible\n                const restoredLocations = urls.map((url, i) => {\n                    // if we have a saved location for this URL, use it\n                    if (progress[url]) return progress[url];\n                    // otherwise keep existing (which might be 0 or already set)\n                    return locations[i];\n                });\n\n                // Only update if different to avoid unnecessary re-renders?\n                // Initial locations are 0.\n                setLocations(restoredLocations);\n            }\n        } catch (e) {\n            console.error(\"Failed to load progress\", e);\n        }\n    }, []); // Run once on mount (window object available)\n\n    // Persistence: Save Logic\n    const saveProgress = (bookUrl: string, loc: LocationType) => {\n        try {\n            const saved = localStorage.getItem('parallel-reader-progress');\n            const progress = saved ? JSON.parse(saved) : {};\n\n            progress[bookUrl] = loc;\n            localStorage.setItem('parallel-reader-progress', JSON.stringify(progress));\n        } catch (e) {\n            console.error(\"Failed to save progress\", e);\n        }\n    };\n\n    const debouncedSave = useDebounce(saveProgress, 1000);\n\n    // Load highlights on mount or when URLs change\n    useEffect(() => {\n        if (urls.length > 0) {\n            const searchParams = new URLSearchParams();\n            searchParams.set('urls', urls.join(','));\n\n            fetch(`/api/highlights?${searchParams.toString()}`)\n                .then(res => res.json())\n                .then(data => setHighlights(data))\n                .catch(err => console.error(\"Error loading highlights:\", err));\n        }\n    }, [urls]);\n\n    // Style Injection Helper\n    const applyStyles = (rendition: Rendition) => {\n        rendition.themes.default({\n            'body': {\n                'font-family': `${settings.fontFamily} !important`,\n                'font-size': `${settings.fontSize}% !important`,\n                'line-height': `${settings.lineHeight} !important`\n            },\n            'p': {\n                'font-family': `${settings.fontFamily} !important`,\n                'font-size': `${settings.fontSize}% !important`,\n                'line-height': `${settings.lineHeight} !important`\n            },\n            'div': { 'padding-bottom': '20px' },\n            '::selection': {\n                'background': 'rgba(255, 255, 0, 0.3)'\n            },\n            // Custom highlight classes\n            '.hl-highlight': { 'fill': 'yellow', 'fill-opacity': '0.3', 'mix-blend-mode': 'multiply' },\n            '.hl-underline': { 'border-bottom': '2px solid red', 'fill': 'transparent' } // Simplified underline\n        });\n    };\n\n    // Update active renditions when settings change\n    useEffect(() => {\n        renditionRefs.current.forEach(rendition => {\n            if (rendition) {\n                applyStyles(rendition);\n            }\n        });\n    }, [settings]);\n\n    // --- Handlers ---\n\n    const getRendition = (index: number, rendition: Rendition) => {\n        renditionRefs.current[index] = rendition;\n\n        // Initial styles\n        applyStyles(rendition);\n\n        // CLEANUP\n        const keysToRemove: string[] = [];\n        renderedRef.current.forEach(key => {\n            if (key.startsWith(`${index}-`)) keysToRemove.push(key);\n        });\n        keysToRemove.forEach(k => renderedRef.current.delete(k));\n\n        // INITIAL RENDER\n        const bookHighlights = highlights.filter(h => h.bookUrl === urls[index]);\n        bookHighlights.forEach(h => {\n            // Use dynamic style class\n            rendition.annotations.add('highlight', h.cfiRange, {}, null, `hl-exist-${h.id}`);\n            renderedRef.current.add(`${index}-${h.id}`);\n        });\n\n        // SELECTION HANDLER\n        rendition.on('selected', (cfiRange: string, contents: any) => {\n            const range = contents.window.getSelection().getRangeAt(0);\n            const rect = range.getBoundingClientRect();\n            const text = range.toString();\n\n            // Calculate absolute position\n            const iframe = rendition.manager.container.querySelector('iframe');\n            if (iframe) {\n                const iframeRect = iframe.getBoundingClientRect();\n                setSelection({\n                    cfiRange,\n                    text,\n                    bookIndex: index,\n                    position: {\n                        top: iframeRect.top + rect.top,\n                        left: iframeRect.left + rect.right\n                    }\n                });\n                setMenuOpen(false); // Start with just the button\n                console.log(\"Selection set at\", iframeRect.top + rect.top, iframeRect.left + rect.right);\n            }\n        });\n\n        // Click handler removed to prevent conflict with selection logic\n        rendition.on('click', () => {\n            // specific logic can be added here if needed to clear selection\n        });\n\n    };\n\n    // Re-apply highlights + Custom Color Injection\n    useEffect(() => {\n        renditionRefs.current.forEach((rendition, index) => {\n            if (!rendition) return;\n\n            const url = urls[index];\n            const bookHighlights = highlights.filter(h => h.bookUrl === url);\n\n            // Inject styles for specific highlight colors\n            bookHighlights.forEach(h => {\n                const className = `hl-exist-${h.id}`;\n                rendition.themes.default({\n                    [`.${className}`]: {\n                        'fill': h.color,\n                        'fill-opacity': '0.3',\n                        'mix-blend-mode': 'multiply',\n                        ...(h.style === 'underline' ? {\n                            'fill': 'transparent',\n                            'border-bottom': `2px solid ${h.color}`\n                        } : {})\n                    }\n                });\n\n                const key = `${index}-${h.id}`;\n                if (!renderedRef.current.has(key)) {\n                    rendition.annotations.add('highlight', h.cfiRange, {}, null, className);\n                    renderedRef.current.add(key);\n                }\n            });\n\n            // Cleanup removed highlights\n            const bookHighlightIds = new Set(bookHighlights.map(h => h.id));\n            const keysToRemove: string[] = [];\n            renderedRef.current.forEach(key => {\n                const [pIdx, hId] = key.split('-');\n                if (parseInt(pIdx) === index && !bookHighlightIds.has(hId)) {\n                    keysToRemove.push(key);\n                }\n            });\n            keysToRemove.forEach(k => renderedRef.current.delete(k));\n        });\n    }, [highlights, urls]);\n\n\n    const handleSaveHighlight = (data: { color: string; style: 'highlight' | 'underline'; note: string }) => {\n        if (!selection) return;\n\n        const newHighlight: Highlight = {\n            id: Date.now().toString(),\n            cfiRange: selection.cfiRange,\n            text: selection.text,\n            bookUrl: urls[selection.bookIndex],\n            created: Date.now(),\n            color: data.color,\n            style: data.style,\n            note: data.note\n        };\n\n        // Optimistic UI\n        setHighlights(prev => [...prev, newHighlight]);\n\n        // Render Immediately\n        const rendition = renditionRefs.current[selection.bookIndex];\n        if (rendition) {\n            const className = `hl-exist-${newHighlight.id}`;\n            rendition.themes.default({\n                [`.${className}`]: {\n                    'fill': newHighlight.color,\n                    'fill-opacity': '0.3',\n                    'mix-blend-mode': 'multiply',\n                    ...(newHighlight.style === 'underline' ? {\n                        'fill': 'transparent',\n                        'border-bottom': `2px solid ${newHighlight.color}`\n                    } : {})\n                }\n            });\n            rendition.annotations.add('highlight', newHighlight.cfiRange, {}, null, className);\n            renderedRef.current.add(`${selection.bookIndex}-${newHighlight.id}`);\n\n            // Clear browser selection\n            try {\n                const contents = rendition.getContents()[0];\n                contents?.window.getSelection()?.removeAllRanges();\n            } catch (e) { console.error(\"Could not clear selection\", e); }\n        }\n\n        // Persist\n        fetch('/api/highlights', {\n            method: 'POST',\n            headers: { 'Content-Type': 'application/json' },\n            body: JSON.stringify(newHighlight)\n        }).catch(err => console.error(\"Failed to save\", err));\n\n        // Reset\n        setSelection(null);\n        setMenuOpen(false);\n    };\n\n    const handleCancelSelection = () => {\n        // Clear browser selection\n        if (selection) {\n            const rendition = renditionRefs.current[selection.bookIndex];\n            try {\n                const contents = rendition?.getContents()[0];\n                contents?.window.getSelection()?.removeAllRanges();\n            } catch (e) { }\n        }\n        setSelection(null);\n        setMenuOpen(false);\n    };\n\n    const handleLocationChange = (index: number, newLocation: LocationType) => {\n        const newLocations = [...locations];\n        newLocations[index] = newLocation;\n        setLocations(newLocations);\n        if (urls[index]) debouncedSave(urls[index], newLocation);\n    };\n\n    const updateUrl = (index: number, newUrl: string) => {\n        const newUrls = [...urls];\n        newUrls[index] = newUrl;\n        setUrls(newUrls);\n    };\n\n    const deleteHighlight = async (id: string, cfiRange: string, bookIndex: number) => {\n        setHighlights(prev => prev.filter(h => h.id !== id));\n        const rendition = renditionRefs.current[bookIndex];\n        if (rendition) {\n            rendition.annotations.remove(cfiRange, 'highlight');\n            renderedRef.current.delete(`${bookIndex}-${id}`);\n        }\n        await fetch('/api/highlights', {\n            method: 'DELETE',\n            headers: { 'Content-Type': 'application/json' },\n            body: JSON.stringify({ id, bookUrl: urls[bookIndex] })\n        });\n    };\n\n    return (\n        <div className={styles.container}>\n            <div className={styles.header}>\n                <div style={{ display: 'flex', alignItems: 'center', gap: '1rem' }}>\n                    {onBack && (\n                        <button onClick={onBack} className={styles.backButton} style={{ background: 'none', border: 'none', cursor: 'pointer', fontSize: '1.2rem' }}>\n                            ‚Üê Back\n                        </button>\n                    )}\n                    <h1>Parallel Reader</h1>\n                </div>\n                <div className={styles.controls}>\n                    <button onClick={() => setShowSettings(!showSettings)} style={{ border: 'none', background: 'none', cursor: 'pointer', fontSize: '1.2rem', marginRight: '0.5rem' }}>‚öôÔ∏è</button>\n                    {showSettings && (\n                        <div className={styles.settingsPanel}>\n                            <h3>Display Settings</h3>\n                            <div className={styles.settingGroup}>\n                                <label>Font Size: {settings.fontSize}%</label>\n                                <input type=\"range\" min=\"80\" max=\"200\" step=\"10\" value={settings.fontSize} onChange={(e) => setSettings({ ...settings, fontSize: Number(e.target.value) })} />\n                            </div>\n                            <div className={styles.settingGroup}>\n                                <label>Font Family</label>\n                                <select value={settings.fontFamily} onChange={(e) => setSettings({ ...settings, fontFamily: e.target.value })}>\n                                    <option value=\"Helvetica, sans-serif\">Helvetica</option>\n                                    <option value=\"Georgia, serif\">Georgia</option>\n                                    <option value=\"Courier New, monospace\">Monospace</option>\n                                    <option value=\"Times New Roman, serif\">Original</option>\n                                </select>\n                            </div>\n                            <div className={styles.settingGroup}>\n                                <label>Line Height</label>\n                                <select value={settings.lineHeight} onChange={(e) => setSettings({ ...settings, lineHeight: Number(e.target.value) })}>\n                                    <option value={1.2}>Compact (1.2)</option>\n                                    <option value={1.6}>Normal (1.6)</option>\n                                    <option value={2.0}>Loose (2.0)</option>\n                                </select>\n                            </div>\n                        </div>\n                    )}\n                    <div className={styles.buttonGroup}>\n                        <button onClick={() => setShowHighlights(!showHighlights)} className={showHighlights ? styles.active : styles.inactive}>\n                            {showHighlights ? 'Hide Notes' : 'Show Notes'}\n                        </button>\n                    </div>\n                    <div className={styles.buttonGroup}>\n                        {[1, 2, 3].map(num => (\n                            <button key={num} onClick={() => setCount(num)} className={count === num ? styles.active : styles.inactive}>\n                                {num} Panel{num > 1 && 's'}\n                            </button>\n                        ))}\n                    </div>\n                </div>\n            </div>\n\n            <div style={{ display: 'flex', flex: 1, overflow: 'hidden', position: 'relative' }}>\n                <div className={styles.grid} style={{ flex: showHighlights ? '0 0 75%' : '1' }}>\n                    {Array.from({ length: count }).map((_, index) => (\n                        <div key={index} className={styles.panel} ref={el => { panelRefs.current[index] = el; }} style={{ maxWidth: `${100 / count}%` }}>\n                            <div className={styles.inputWrapper}>\n                                <input type=\"text\" placeholder=\"Paste EPUB URL here...\" value={urls[index] || ''} onChange={(e) => updateUrl(index, e.target.value)} />\n                            </div>\n                            <div className={styles.readerWrapper}>\n                                <ReactReader\n                                    url={urls[index]}\n                                    location={locations[index] || 0}\n                                    locationChanged={(loc) => handleLocationChange(index, loc)}\n                                    getRendition={(rendition: any) => getRendition(index, rendition)}\n                                    epubOptions={{ flow: \"scrolled\", manager: \"continuous\" }}\n                                    swipeable={false}\n                                    readerStyles={{ ...ReactReaderStyle, arrow: { ...ReactReaderStyle.arrow, display: 'none' } }}\n                                />\n                            </div>\n                        </div>\n                    ))}\n                </div>\n\n                {showHighlights && (\n                    <div className={styles.sidebar}>\n                        <h2>Annotations</h2>\n                        {highlights.length === 0 && <p className={styles.emptyState}>Select text to highlight.</p>}\n                        {highlights.map(h => (\n                            <div key={h.id} className={styles.annotationCard} style={{ borderLeft: `4px solid ${h.color}` }}>\n                                <p>\"{h.text}\"</p>\n                                {h.note && <p style={{ fontStyle: 'italic', fontSize: '0.85rem', color: '#555' }}>{h.note}</p>}\n                                <div className={styles.footer}>\n                                    <span>{urls.findIndex(u => u === h.bookUrl) > -1 ? `Panel ${urls.findIndex(u => u === h.bookUrl) + 1}` : 'Other Book'}</span>\n                                    <div className={styles.actions}>\n                                        <button className={styles.jump} onClick={() => {\n                                            const idx = urls.indexOf(h.bookUrl);\n                                            if (idx !== -1 && renditionRefs.current[idx]) {\n                                                renditionRefs.current[idx]?.display(h.cfiRange);\n                                            }\n                                        }}>Jump</button>\n                                        <button className={styles.delete} onClick={() => deleteHighlight(h.id, h.cfiRange, urls.indexOf(h.bookUrl))}>Delete</button>\n                                    </div>\n                                </div>\n                            </div>\n                        ))}\n                    </div>\n                )}\n\n                {/* Popover UI */}\n                {selection && (\n                    <div className={styles.popoverContainer} style={{ top: selection.position.top - 40, left: selection.position.left }}>\n                        {!menuOpen ? (\n                            <button className={styles.popoverButton} onClick={() => setMenuOpen(true)}>\n                                +\n                            </button>\n                        ) : (\n                            <SelectionMenu\n                                isEditing={false} // Creating new\n                                onSave={handleSaveHighlight}\n                                onCancel={handleCancelSelection}\n                            />\n                        )}\n                    </div>\n                )}\n\n            </div>\n        </div>\n    );\n}"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;AACA;AAEA;;;;;;;AAkBe,SAAS,eAAe,EAAE,WAAW,EAAE,MAAM,EAAuB;IAC/E,gBAAgB;IAChB,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,iNAAQ,EAAW;IAC3C,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,iNAAQ,EAAC,YAAY,MAAM,IAAI;IACzD,4DAA4D;IAC5D,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,iNAAQ,EAAiB,YAAY,GAAG,CAAC,IAAM;IAEjF,mBAAmB;IACnB,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,iNAAQ,EAAc,EAAE;IAC5D,MAAM,CAAC,gBAAgB,kBAAkB,GAAG,IAAA,iNAAQ,EAAC;IAErD,4BAA4B;IAC5B,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,iNAAQ,EAAwB;IAClE,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,iNAAQ,EAAC;IACzC,MAAM,CAAC,kBAAkB,oBAAoB,GAAG,IAAA,iNAAQ,EAAmB;IAE3E,gBAAgB;IAChB,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,iNAAQ,EAAC;IACjD,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,iNAAQ,EAAC;QACrC,UAAU;QACV,YAAY;QACZ,YAAY;IAChB;IAEA,MAAM,gBAAgB,IAAA,+MAAM,EAAuB,EAAE;IACrD,4DAA4D;IAC5D,MAAM,cAAc,IAAA,+MAAM,EAAc,IAAI;IAE5C,+CAA+C;IAC/C,MAAM,YAAY,IAAA,+MAAM,EAA4B,EAAE;IAEtD,4DAA4D;IAC5D,IAAA,kNAAS,EAAC;QACN,IAAI;YACA,MAAM,QAAQ,aAAa,OAAO,CAAC;YACnC,IAAI,OAAO;gBACP,MAAM,WAAW,KAAK,KAAK,CAAC;gBAE5B,iCAAiC;gBACjC,0EAA0E;gBAC1E,MAAM,oBAAoB,KAAK,GAAG,CAAC,CAAC,KAAK;oBACrC,mDAAmD;oBACnD,IAAI,QAAQ,CAAC,IAAI,EAAE,OAAO,QAAQ,CAAC,IAAI;oBACvC,4DAA4D;oBAC5D,OAAO,SAAS,CAAC,EAAE;gBACvB;gBAEA,4DAA4D;gBAC5D,2BAA2B;gBAC3B,aAAa;YACjB;QACJ,EAAE,OAAO,GAAG;YACR,QAAQ,KAAK,CAAC,2BAA2B;QAC7C;IACJ,GAAG,EAAE,GAAG,8CAA8C;IAEtD,0BAA0B;IAC1B,MAAM,eAAe,CAAC,SAAiB;QACnC,IAAI;YACA,MAAM,QAAQ,aAAa,OAAO,CAAC;YACnC,MAAM,WAAW,QAAQ,KAAK,KAAK,CAAC,SAAS,CAAC;YAE9C,QAAQ,CAAC,QAAQ,GAAG;YACpB,aAAa,OAAO,CAAC,4BAA4B,KAAK,SAAS,CAAC;QACpE,EAAE,OAAO,GAAG;YACR,QAAQ,KAAK,CAAC,2BAA2B;QAC7C;IACJ;IAEA,MAAM,gBAAgB,IAAA,0IAAW,EAAC,cAAc;IAEhD,+CAA+C;IAC/C,IAAA,kNAAS,EAAC;QACN,IAAI,KAAK,MAAM,GAAG,GAAG;YACjB,MAAM,eAAe,IAAI;YACzB,aAAa,GAAG,CAAC,QAAQ,KAAK,IAAI,CAAC;YAEnC,MAAM,CAAC,gBAAgB,EAAE,aAAa,QAAQ,IAAI,EAC7C,IAAI,CAAC,CAAA,MAAO,IAAI,IAAI,IACpB,IAAI,CAAC,CAAA,OAAQ,cAAc,OAC3B,KAAK,CAAC,CAAA,MAAO,QAAQ,KAAK,CAAC,6BAA6B;QACjE;IACJ,GAAG;QAAC;KAAK;IAET,yBAAyB;IACzB,MAAM,cAAc,CAAC;QACjB,UAAU,MAAM,CAAC,OAAO,CAAC;YACrB,QAAQ;gBACJ,eAAe,GAAG,SAAS,UAAU,CAAC,WAAW,CAAC;gBAClD,aAAa,GAAG,SAAS,QAAQ,CAAC,YAAY,CAAC;gBAC/C,eAAe,GAAG,SAAS,UAAU,CAAC,WAAW,CAAC;YACtD;YACA,KAAK;gBACD,eAAe,GAAG,SAAS,UAAU,CAAC,WAAW,CAAC;gBAClD,aAAa,GAAG,SAAS,QAAQ,CAAC,YAAY,CAAC;gBAC/C,eAAe,GAAG,SAAS,UAAU,CAAC,WAAW,CAAC;YACtD;YACA,OAAO;gBAAE,kBAAkB;YAAO;YAClC,eAAe;gBACX,cAAc;YAClB;YACA,2BAA2B;YAC3B,iBAAiB;gBAAE,QAAQ;gBAAU,gBAAgB;gBAAO,kBAAkB;YAAW;YACzF,iBAAiB;gBAAE,iBAAiB;gBAAiB,QAAQ;YAAc,EAAE,uBAAuB;QACxG;IACJ;IAEA,gDAAgD;IAChD,IAAA,kNAAS,EAAC;QACN,cAAc,OAAO,CAAC,OAAO,CAAC,CAAA;YAC1B,IAAI,WAAW;gBACX,YAAY;YAChB;QACJ;IACJ,GAAG;QAAC;KAAS;IAEb,mBAAmB;IAEnB,MAAM,eAAe,CAAC,OAAe;QACjC,cAAc,OAAO,CAAC,MAAM,GAAG;QAE/B,iBAAiB;QACjB,YAAY;QAEZ,UAAU;QACV,MAAM,eAAyB,EAAE;QACjC,YAAY,OAAO,CAAC,OAAO,CAAC,CAAA;YACxB,IAAI,IAAI,UAAU,CAAC,GAAG,MAAM,CAAC,CAAC,GAAG,aAAa,IAAI,CAAC;QACvD;QACA,aAAa,OAAO,CAAC,CAAA,IAAK,YAAY,OAAO,CAAC,MAAM,CAAC;QAErD,iBAAiB;QACjB,MAAM,iBAAiB,WAAW,MAAM,CAAC,CAAA,IAAK,EAAE,OAAO,KAAK,IAAI,CAAC,MAAM;QACvE,eAAe,OAAO,CAAC,CAAA;YACnB,0BAA0B;YAC1B,UAAU,WAAW,CAAC,GAAG,CAAC,aAAa,EAAE,QAAQ,EAAE,CAAC,GAAG,MAAM,CAAC,SAAS,EAAE,EAAE,EAAE,EAAE;YAC/E,YAAY,OAAO,CAAC,GAAG,CAAC,GAAG,MAAM,CAAC,EAAE,EAAE,EAAE,EAAE;QAC9C;QAEA,oBAAoB;QACpB,UAAU,EAAE,CAAC,YAAY,CAAC,UAAkB;YACxC,MAAM,QAAQ,SAAS,MAAM,CAAC,YAAY,GAAG,UAAU,CAAC;YACxD,MAAM,OAAO,MAAM,qBAAqB;YACxC,MAAM,OAAO,MAAM,QAAQ;YAE3B,8BAA8B;YAC9B,MAAM,SAAS,UAAU,OAAO,CAAC,SAAS,CAAC,aAAa,CAAC;YACzD,IAAI,QAAQ;gBACR,MAAM,aAAa,OAAO,qBAAqB;gBAC/C,aAAa;oBACT;oBACA;oBACA,WAAW;oBACX,UAAU;wBACN,KAAK,WAAW,GAAG,GAAG,KAAK,GAAG;wBAC9B,MAAM,WAAW,IAAI,GAAG,KAAK,KAAK;oBACtC;gBACJ;gBACA,YAAY,QAAQ,6BAA6B;gBACjD,QAAQ,GAAG,CAAC,oBAAoB,WAAW,GAAG,GAAG,KAAK,GAAG,EAAE,WAAW,IAAI,GAAG,KAAK,KAAK;YAC3F;QACJ;QAEA,iEAAiE;QACjE,UAAU,EAAE,CAAC,SAAS;QAClB,gEAAgE;QACpE;IAEJ;IAEA,+CAA+C;IAC/C,IAAA,kNAAS,EAAC;QACN,cAAc,OAAO,CAAC,OAAO,CAAC,CAAC,WAAW;YACtC,IAAI,CAAC,WAAW;YAEhB,MAAM,MAAM,IAAI,CAAC,MAAM;YACvB,MAAM,iBAAiB,WAAW,MAAM,CAAC,CAAA,IAAK,EAAE,OAAO,KAAK;YAE5D,8CAA8C;YAC9C,eAAe,OAAO,CAAC,CAAA;gBACnB,MAAM,YAAY,CAAC,SAAS,EAAE,EAAE,EAAE,EAAE;gBACpC,UAAU,MAAM,CAAC,OAAO,CAAC;oBACrB,CAAC,CAAC,CAAC,EAAE,WAAW,CAAC,EAAE;wBACf,QAAQ,EAAE,KAAK;wBACf,gBAAgB;wBAChB,kBAAkB;wBAClB,GAAI,EAAE,KAAK,KAAK,cAAc;4BAC1B,QAAQ;4BACR,iBAAiB,CAAC,UAAU,EAAE,EAAE,KAAK,EAAE;wBAC3C,IAAI,CAAC,CAAC;oBACV;gBACJ;gBAEA,MAAM,MAAM,GAAG,MAAM,CAAC,EAAE,EAAE,EAAE,EAAE;gBAC9B,IAAI,CAAC,YAAY,OAAO,CAAC,GAAG,CAAC,MAAM;oBAC/B,UAAU,WAAW,CAAC,GAAG,CAAC,aAAa,EAAE,QAAQ,EAAE,CAAC,GAAG,MAAM;oBAC7D,YAAY,OAAO,CAAC,GAAG,CAAC;gBAC5B;YACJ;YAEA,6BAA6B;YAC7B,MAAM,mBAAmB,IAAI,IAAI,eAAe,GAAG,CAAC,CAAA,IAAK,EAAE,EAAE;YAC7D,MAAM,eAAyB,EAAE;YACjC,YAAY,OAAO,CAAC,OAAO,CAAC,CAAA;gBACxB,MAAM,CAAC,MAAM,IAAI,GAAG,IAAI,KAAK,CAAC;gBAC9B,IAAI,SAAS,UAAU,SAAS,CAAC,iBAAiB,GAAG,CAAC,MAAM;oBACxD,aAAa,IAAI,CAAC;gBACtB;YACJ;YACA,aAAa,OAAO,CAAC,CAAA,IAAK,YAAY,OAAO,CAAC,MAAM,CAAC;QACzD;IACJ,GAAG;QAAC;QAAY;KAAK;IAGrB,MAAM,sBAAsB,CAAC;QACzB,IAAI,CAAC,WAAW;QAEhB,MAAM,eAA0B;YAC5B,IAAI,KAAK,GAAG,GAAG,QAAQ;YACvB,UAAU,UAAU,QAAQ;YAC5B,MAAM,UAAU,IAAI;YACpB,SAAS,IAAI,CAAC,UAAU,SAAS,CAAC;YAClC,SAAS,KAAK,GAAG;YACjB,OAAO,KAAK,KAAK;YACjB,OAAO,KAAK,KAAK;YACjB,MAAM,KAAK,IAAI;QACnB;QAEA,gBAAgB;QAChB,cAAc,CAAA,OAAQ;mBAAI;gBAAM;aAAa;QAE7C,qBAAqB;QACrB,MAAM,YAAY,cAAc,OAAO,CAAC,UAAU,SAAS,CAAC;QAC5D,IAAI,WAAW;YACX,MAAM,YAAY,CAAC,SAAS,EAAE,aAAa,EAAE,EAAE;YAC/C,UAAU,MAAM,CAAC,OAAO,CAAC;gBACrB,CAAC,CAAC,CAAC,EAAE,WAAW,CAAC,EAAE;oBACf,QAAQ,aAAa,KAAK;oBAC1B,gBAAgB;oBAChB,kBAAkB;oBAClB,GAAI,aAAa,KAAK,KAAK,cAAc;wBACrC,QAAQ;wBACR,iBAAiB,CAAC,UAAU,EAAE,aAAa,KAAK,EAAE;oBACtD,IAAI,CAAC,CAAC;gBACV;YACJ;YACA,UAAU,WAAW,CAAC,GAAG,CAAC,aAAa,aAAa,QAAQ,EAAE,CAAC,GAAG,MAAM;YACxE,YAAY,OAAO,CAAC,GAAG,CAAC,GAAG,UAAU,SAAS,CAAC,CAAC,EAAE,aAAa,EAAE,EAAE;YAEnE,0BAA0B;YAC1B,IAAI;gBACA,MAAM,WAAW,UAAU,WAAW,EAAE,CAAC,EAAE;gBAC3C,UAAU,OAAO,gBAAgB;YACrC,EAAE,OAAO,GAAG;gBAAE,QAAQ,KAAK,CAAC,6BAA6B;YAAI;QACjE;QAEA,UAAU;QACV,MAAM,mBAAmB;YACrB,QAAQ;YACR,SAAS;gBAAE,gBAAgB;YAAmB;YAC9C,MAAM,KAAK,SAAS,CAAC;QACzB,GAAG,KAAK,CAAC,CAAA,MAAO,QAAQ,KAAK,CAAC,kBAAkB;QAEhD,QAAQ;QACR,aAAa;QACb,YAAY;IAChB;IAEA,MAAM,wBAAwB;QAC1B,0BAA0B;QAC1B,IAAI,WAAW;YACX,MAAM,YAAY,cAAc,OAAO,CAAC,UAAU,SAAS,CAAC;YAC5D,IAAI;gBACA,MAAM,WAAW,WAAW,aAAa,CAAC,EAAE;gBAC5C,UAAU,OAAO,gBAAgB;YACrC,EAAE,OAAO,GAAG,CAAE;QAClB;QACA,aAAa;QACb,YAAY;IAChB;IAEA,MAAM,uBAAuB,CAAC,OAAe;QACzC,MAAM,eAAe;eAAI;SAAU;QACnC,YAAY,CAAC,MAAM,GAAG;QACtB,aAAa;QACb,IAAI,IAAI,CAAC,MAAM,EAAE,cAAc,IAAI,CAAC,MAAM,EAAE;IAChD;IAEA,MAAM,YAAY,CAAC,OAAe;QAC9B,MAAM,UAAU;eAAI;SAAK;QACzB,OAAO,CAAC,MAAM,GAAG;QACjB,QAAQ;IACZ;IAEA,MAAM,kBAAkB,OAAO,IAAY,UAAkB;QACzD,cAAc,CAAA,OAAQ,KAAK,MAAM,CAAC,CAAA,IAAK,EAAE,EAAE,KAAK;QAChD,MAAM,YAAY,cAAc,OAAO,CAAC,UAAU;QAClD,IAAI,WAAW;YACX,UAAU,WAAW,CAAC,MAAM,CAAC,UAAU;YACvC,YAAY,OAAO,CAAC,MAAM,CAAC,GAAG,UAAU,CAAC,EAAE,IAAI;QACnD;QACA,MAAM,MAAM,mBAAmB;YAC3B,QAAQ;YACR,SAAS;gBAAE,gBAAgB;YAAmB;YAC9C,MAAM,KAAK,SAAS,CAAC;gBAAE;gBAAI,SAAS,IAAI,CAAC,UAAU;YAAC;QACxD;IACJ;IAEA,qBACI,8OAAC;QAAI,WAAW,2JAAM,CAAC,SAAS;;0BAC5B,8OAAC;gBAAI,WAAW,2JAAM,CAAC,MAAM;;kCACzB,8OAAC;wBAAI,OAAO;4BAAE,SAAS;4BAAQ,YAAY;4BAAU,KAAK;wBAAO;;4BAC5D,wBACG,8OAAC;gCAAO,SAAS;gCAAQ,WAAW,2JAAM,CAAC,UAAU;gCAAE,OAAO;oCAAE,YAAY;oCAAQ,QAAQ;oCAAQ,QAAQ;oCAAW,UAAU;gCAAS;0CAAG;;;;;;0CAIjJ,8OAAC;0CAAG;;;;;;;;;;;;kCAER,8OAAC;wBAAI,WAAW,2JAAM,CAAC,QAAQ;;0CAC3B,8OAAC;gCAAO,SAAS,IAAM,gBAAgB,CAAC;gCAAe,OAAO;oCAAE,QAAQ;oCAAQ,YAAY;oCAAQ,QAAQ;oCAAW,UAAU;oCAAU,aAAa;gCAAS;0CAAG;;;;;;4BACnK,8BACG,8OAAC;gCAAI,WAAW,2JAAM,CAAC,aAAa;;kDAChC,8OAAC;kDAAG;;;;;;kDACJ,8OAAC;wCAAI,WAAW,2JAAM,CAAC,YAAY;;0DAC/B,8OAAC;;oDAAM;oDAAY,SAAS,QAAQ;oDAAC;;;;;;;0DACrC,8OAAC;gDAAM,MAAK;gDAAQ,KAAI;gDAAK,KAAI;gDAAM,MAAK;gDAAK,OAAO,SAAS,QAAQ;gDAAE,UAAU,CAAC,IAAM,YAAY;wDAAE,GAAG,QAAQ;wDAAE,UAAU,OAAO,EAAE,MAAM,CAAC,KAAK;oDAAE;;;;;;;;;;;;kDAE5J,8OAAC;wCAAI,WAAW,2JAAM,CAAC,YAAY;;0DAC/B,8OAAC;0DAAM;;;;;;0DACP,8OAAC;gDAAO,OAAO,SAAS,UAAU;gDAAE,UAAU,CAAC,IAAM,YAAY;wDAAE,GAAG,QAAQ;wDAAE,YAAY,EAAE,MAAM,CAAC,KAAK;oDAAC;;kEACvG,8OAAC;wDAAO,OAAM;kEAAwB;;;;;;kEACtC,8OAAC;wDAAO,OAAM;kEAAiB;;;;;;kEAC/B,8OAAC;wDAAO,OAAM;kEAAyB;;;;;;kEACvC,8OAAC;wDAAO,OAAM;kEAAyB;;;;;;;;;;;;;;;;;;kDAG/C,8OAAC;wCAAI,WAAW,2JAAM,CAAC,YAAY;;0DAC/B,8OAAC;0DAAM;;;;;;0DACP,8OAAC;gDAAO,OAAO,SAAS,UAAU;gDAAE,UAAU,CAAC,IAAM,YAAY;wDAAE,GAAG,QAAQ;wDAAE,YAAY,OAAO,EAAE,MAAM,CAAC,KAAK;oDAAE;;kEAC/G,8OAAC;wDAAO,OAAO;kEAAK;;;;;;kEACpB,8OAAC;wDAAO,OAAO;kEAAK;;;;;;kEACpB,8OAAC;wDAAO,OAAO;kEAAK;;;;;;;;;;;;;;;;;;;;;;;;0CAKpC,8OAAC;gCAAI,WAAW,2JAAM,CAAC,WAAW;0CAC9B,cAAA,8OAAC;oCAAO,SAAS,IAAM,kBAAkB,CAAC;oCAAiB,WAAW,iBAAiB,2JAAM,CAAC,MAAM,GAAG,2JAAM,CAAC,QAAQ;8CACjH,iBAAiB,eAAe;;;;;;;;;;;0CAGzC,8OAAC;gCAAI,WAAW,2JAAM,CAAC,WAAW;0CAC7B;oCAAC;oCAAG;oCAAG;iCAAE,CAAC,GAAG,CAAC,CAAA,oBACX,8OAAC;wCAAiB,SAAS,IAAM,SAAS;wCAAM,WAAW,UAAU,MAAM,2JAAM,CAAC,MAAM,GAAG,2JAAM,CAAC,QAAQ;;4CACrG;4CAAI;4CAAO,MAAM,KAAK;;uCADd;;;;;;;;;;;;;;;;;;;;;;0BAQ7B,8OAAC;gBAAI,OAAO;oBAAE,SAAS;oBAAQ,MAAM;oBAAG,UAAU;oBAAU,UAAU;gBAAW;;kCAC7E,8OAAC;wBAAI,WAAW,2JAAM,CAAC,IAAI;wBAAE,OAAO;4BAAE,MAAM,iBAAiB,YAAY;wBAAI;kCACxE,MAAM,IAAI,CAAC;4BAAE,QAAQ;wBAAM,GAAG,GAAG,CAAC,CAAC,GAAG,sBACnC,8OAAC;gCAAgB,WAAW,2JAAM,CAAC,KAAK;gCAAE,KAAK,CAAA;oCAAQ,UAAU,OAAO,CAAC,MAAM,GAAG;gCAAI;gCAAG,OAAO;oCAAE,UAAU,GAAG,MAAM,MAAM,CAAC,CAAC;gCAAC;;kDAC1H,8OAAC;wCAAI,WAAW,2JAAM,CAAC,YAAY;kDAC/B,cAAA,8OAAC;4CAAM,MAAK;4CAAO,aAAY;4CAAyB,OAAO,IAAI,CAAC,MAAM,IAAI;4CAAI,UAAU,CAAC,IAAM,UAAU,OAAO,EAAE,MAAM,CAAC,KAAK;;;;;;;;;;;kDAEtI,8OAAC;wCAAI,WAAW,2JAAM,CAAC,aAAa;kDAChC,cAAA,8OAAC,+KAAW;4CACR,KAAK,IAAI,CAAC,MAAM;4CAChB,UAAU,SAAS,CAAC,MAAM,IAAI;4CAC9B,iBAAiB,CAAC,MAAQ,qBAAqB,OAAO;4CACtD,cAAc,CAAC,YAAmB,aAAa,OAAO;4CACtD,aAAa;gDAAE,MAAM;gDAAY,SAAS;4CAAa;4CACvD,WAAW;4CACX,cAAc;gDAAE,GAAG,oLAAgB;gDAAE,OAAO;oDAAE,GAAG,oLAAgB,CAAC,KAAK;oDAAE,SAAS;gDAAO;4CAAE;;;;;;;;;;;;+BAZ7F;;;;;;;;;;oBAmBjB,gCACG,8OAAC;wBAAI,WAAW,2JAAM,CAAC,OAAO;;0CAC1B,8OAAC;0CAAG;;;;;;4BACH,WAAW,MAAM,KAAK,mBAAK,8OAAC;gCAAE,WAAW,2JAAM,CAAC,UAAU;0CAAE;;;;;;4BAC5D,WAAW,GAAG,CAAC,CAAA,kBACZ,8OAAC;oCAAe,WAAW,2JAAM,CAAC,cAAc;oCAAE,OAAO;wCAAE,YAAY,CAAC,UAAU,EAAE,EAAE,KAAK,EAAE;oCAAC;;sDAC1F,8OAAC;;gDAAE;gDAAE,EAAE,IAAI;gDAAC;;;;;;;wCACX,EAAE,IAAI,kBAAI,8OAAC;4CAAE,OAAO;gDAAE,WAAW;gDAAU,UAAU;gDAAW,OAAO;4CAAO;sDAAI,EAAE,IAAI;;;;;;sDACzF,8OAAC;4CAAI,WAAW,2JAAM,CAAC,MAAM;;8DACzB,8OAAC;8DAAM,KAAK,SAAS,CAAC,CAAA,IAAK,MAAM,EAAE,OAAO,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE,KAAK,SAAS,CAAC,CAAA,IAAK,MAAM,EAAE,OAAO,IAAI,GAAG,GAAG;;;;;;8DACzG,8OAAC;oDAAI,WAAW,2JAAM,CAAC,OAAO;;sEAC1B,8OAAC;4DAAO,WAAW,2JAAM,CAAC,IAAI;4DAAE,SAAS;gEACrC,MAAM,MAAM,KAAK,OAAO,CAAC,EAAE,OAAO;gEAClC,IAAI,QAAQ,CAAC,KAAK,cAAc,OAAO,CAAC,IAAI,EAAE;oEAC1C,cAAc,OAAO,CAAC,IAAI,EAAE,QAAQ,EAAE,QAAQ;gEAClD;4DACJ;sEAAG;;;;;;sEACH,8OAAC;4DAAO,WAAW,2JAAM,CAAC,MAAM;4DAAE,SAAS,IAAM,gBAAgB,EAAE,EAAE,EAAE,EAAE,QAAQ,EAAE,KAAK,OAAO,CAAC,EAAE,OAAO;sEAAI;;;;;;;;;;;;;;;;;;;mCAZ/G,EAAE,EAAE;;;;;;;;;;;oBAqBzB,2BACG,8OAAC;wBAAI,WAAW,2JAAM,CAAC,gBAAgB;wBAAE,OAAO;4BAAE,KAAK,UAAU,QAAQ,CAAC,GAAG,GAAG;4BAAI,MAAM,UAAU,QAAQ,CAAC,IAAI;wBAAC;kCAC7G,CAAC,yBACE,8OAAC;4BAAO,WAAW,2JAAM,CAAC,aAAa;4BAAE,SAAS,IAAM,YAAY;sCAAO;;;;;iDAI3E,8OAAC,8IAAa;4BACV,WAAW;4BACX,QAAQ;4BACR,UAAU;;;;;;;;;;;;;;;;;;;;;;;AAS1C"}},
    {"offset": {"line": 1112, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/app/components/Bookshelf.module.scss [app-ssr] (css module)"],"sourcesContent":["__turbopack_context__.v({\n  \"arrow\": \"Bookshelf-module-scss-module__3Di2QW__arrow\",\n  \"bookCount\": \"Bookshelf-module-scss-module__3Di2QW__bookCount\",\n  \"card\": \"Bookshelf-module-scss-module__3Di2QW__card\",\n  \"cardContent\": \"Bookshelf-module-scss-module__3Di2QW__cardContent\",\n  \"collectionName\": \"Bookshelf-module-scss-module__3Di2QW__collectionName\",\n  \"container\": \"Bookshelf-module-scss-module__3Di2QW__container\",\n  \"emptyState\": \"Bookshelf-module-scss-module__3Di2QW__emptyState\",\n  \"list\": \"Bookshelf-module-scss-module__3Di2QW__list\",\n  \"loading\": \"Bookshelf-module-scss-module__3Di2QW__loading\",\n  \"subtitle\": \"Bookshelf-module-scss-module__3Di2QW__subtitle\",\n  \"title\": \"Bookshelf-module-scss-module__3Di2QW__title\",\n});\n"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA"}},
    {"offset": {"line": 1129, "column": 0}, "map": {"version":3,"sources":["file:///Users/mats/Code/react-parallel-reader/app/components/Bookshelf.tsx"],"sourcesContent":["'use client';\n\nimport React, { useEffect, useState } from 'react';\nimport type { BookCollection } from '../../types/epub';\nimport styles from './Bookshelf.module.scss';\n\ninterface BookshelfProps {\n    onSelectCollection: (files: string[]) => void;\n}\n\nexport default function Bookshelf({ onSelectCollection }: BookshelfProps) {\n    const [collections, setCollections] = useState<BookCollection[]>([]);\n    const [loading, setLoading] = useState(true);\n\n    useEffect(() => {\n        fetch('/api/books')\n            .then((res) => res.json())\n            .then((data) => {\n                setCollections(data);\n                setLoading(false);\n            })\n            .catch((err) => {\n                console.error('Failed to load books:', err);\n                setLoading(false);\n            });\n    }, []);\n\n    if (loading) return <div className={styles.loading}>Loading library...</div>;\n\n    return (\n        <div className={styles.container}>\n            <h1 className={styles.title}>My Collections</h1>\n\n            {collections.length === 0 ? (\n                <div className={styles.emptyState}>\n                    <p>No collections found in <code>public/books/</code>.</p>\n                    <p className={styles.subtitle}>Create a subfolder (e.g., <code>public/books/classics/</code>) and add EPUB files to start.</p>\n                </div>\n            ) : (\n                <div className={styles.list}>\n                    {collections.map((collection) => (\n                        <div\n                            key={collection.name}\n                            className={styles.card}\n                            onClick={() => onSelectCollection(collection.files)}\n                        >\n                            <div className={styles.cardContent}>\n                                <div>\n                                    <h3 className={styles.collectionName}>\n                                        {collection.name.replace(/-/g, ' ')}\n                                    </h3>\n                                    <p className={styles.bookCount}>\n                                        {collection.files.length} book{collection.files.length !== 1 && 's'}\n                                    </p>\n                                </div>\n                                <div className={styles.arrow}>\n                                    <span style={{ fontSize: '1.5rem' }}>‚Üí</span>\n                                </div>\n                            </div>\n                        </div>\n                    ))}\n                </div>\n            )}\n        </div>\n    );\n}\n"],"names":[],"mappings":";;;;;AAEA;AAEA;AAJA;;;;AAUe,SAAS,UAAU,EAAE,kBAAkB,EAAkB;IACpE,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,iNAAQ,EAAmB,EAAE;IACnE,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,iNAAQ,EAAC;IAEvC,IAAA,kNAAS,EAAC;QACN,MAAM,cACD,IAAI,CAAC,CAAC,MAAQ,IAAI,IAAI,IACtB,IAAI,CAAC,CAAC;YACH,eAAe;YACf,WAAW;QACf,GACC,KAAK,CAAC,CAAC;YACJ,QAAQ,KAAK,CAAC,yBAAyB;YACvC,WAAW;QACf;IACR,GAAG,EAAE;IAEL,IAAI,SAAS,qBAAO,8OAAC;QAAI,WAAW,sJAAM,CAAC,OAAO;kBAAE;;;;;;IAEpD,qBACI,8OAAC;QAAI,WAAW,sJAAM,CAAC,SAAS;;0BAC5B,8OAAC;gBAAG,WAAW,sJAAM,CAAC,KAAK;0BAAE;;;;;;YAE5B,YAAY,MAAM,KAAK,kBACpB,8OAAC;gBAAI,WAAW,sJAAM,CAAC,UAAU;;kCAC7B,8OAAC;;4BAAE;0CAAwB,8OAAC;0CAAK;;;;;;4BAAoB;;;;;;;kCACrD,8OAAC;wBAAE,WAAW,sJAAM,CAAC,QAAQ;;4BAAE;0CAA0B,8OAAC;0CAAK;;;;;;4BAA6B;;;;;;;;;;;;qCAGhG,8OAAC;gBAAI,WAAW,sJAAM,CAAC,IAAI;0BACtB,YAAY,GAAG,CAAC,CAAC,2BACd,8OAAC;wBAEG,WAAW,sJAAM,CAAC,IAAI;wBACtB,SAAS,IAAM,mBAAmB,WAAW,KAAK;kCAElD,cAAA,8OAAC;4BAAI,WAAW,sJAAM,CAAC,WAAW;;8CAC9B,8OAAC;;sDACG,8OAAC;4CAAG,WAAW,sJAAM,CAAC,cAAc;sDAC/B,WAAW,IAAI,CAAC,OAAO,CAAC,MAAM;;;;;;sDAEnC,8OAAC;4CAAE,WAAW,sJAAM,CAAC,SAAS;;gDACzB,WAAW,KAAK,CAAC,MAAM;gDAAC;gDAAM,WAAW,KAAK,CAAC,MAAM,KAAK,KAAK;;;;;;;;;;;;;8CAGxE,8OAAC;oCAAI,WAAW,sJAAM,CAAC,KAAK;8CACxB,cAAA,8OAAC;wCAAK,OAAO;4CAAE,UAAU;wCAAS;kDAAG;;;;;;;;;;;;;;;;;uBAdxC,WAAW,IAAI;;;;;;;;;;;;;;;;AAuBhD"}},
    {"offset": {"line": 1294, "column": 0}, "map": {"version":3,"sources":["file:///Users/mats/Code/react-parallel-reader/app/page.tsx"],"sourcesContent":["'use client';\n\nimport React, { useState } from \"react\";\nimport ParallelReader from \"./components/ParallelReader\";\nimport Bookshelf from \"./components/Bookshelf\";\n\nexport default function Home() {\n  const [selectedBooks, setSelectedBooks] = useState<string[] | null>(null);\n\n  return (\n    <main className=\"min-h-screen bg-gray-50\">\n      {selectedBooks ? (\n        <ParallelReader\n          initialUrls={selectedBooks}\n          onBack={() => setSelectedBooks(null)}\n        />\n      ) : (\n        <Bookshelf onSelectCollection={setSelectedBooks} />\n      )}\n    </main>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAJA;;;;;AAMe,SAAS;IACtB,MAAM,CAAC,eAAe,iBAAiB,GAAG,IAAA,iNAAQ,EAAkB;IAEpE,qBACE,8OAAC;QAAK,WAAU;kBACb,8BACC,8OAAC,+IAAc;YACb,aAAa;YACb,QAAQ,IAAM,iBAAiB;;;;;iCAGjC,8OAAC,0IAAS;YAAC,oBAAoB;;;;;;;;;;;AAIvC"}}]
}